!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){var t,e;t=void 0,e=function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}function r(t){return t&&t.Math==Math&&t}function l(t){try{return!!t()}catch(t){return!0}}function R(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function o(t){return c.call(t).slice(8,-1)}function p(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function f(t){return E(p(t))}function L(t){return"object"==typeof t?null!==t:"function"==typeof t}function s(t,e){if(!L(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!L(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!L(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!L(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}function h(t,e){return g.call(t,e)}function n(t){return m?v.createElement(t):{}}function w(t){if(!L(t))throw TypeError(String(t)+" is not an object");return t}function d(e,r){try{N(D,e,r)}catch(t){D[e]=r}return r}var D=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||Function("return this")(),U=!l(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),i={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,y={f:a&&!i.call({1:2},1)?function(t){var e=a(this,t);return!!e&&e.enumerable}:i},c={}.toString,u="".split,E=l(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?u.call(t,""):Object(t)}:Object,g={}.hasOwnProperty,v=D.document,m=L(v)&&L(v.createElement),b=!U&&!l(function(){return 7!=Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a}),T=Object.getOwnPropertyDescriptor,_={f:U?T:function(t,e){if(t=f(t),e=s(e,!0),b)try{return T(t,e)}catch(t){}if(h(t,e))return R(!y.f.call(t,e),t[e])}},A=Object.defineProperty,M={f:U?A:function(t,e,r){if(w(t),e=s(e,!0),w(r),b)try{return A(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},N=U?function(t,e,r){return M.f(t,e,R(1,r))}:function(t,e,r){return t[e]=r,t},x="__core-js_shared__",S=D[x]||d(x,{}),O=Function.toString;"function"!=typeof S.inspectSource&&(S.inspectSource=function(t){return O.call(t)});function C(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++q+W).toString(36)}function P(t){return Y[t]||(Y[t]=C(t))}var I,j,F,k=S.inspectSource,B=D.WeakMap,G="function"==typeof B&&/native code/.test(k(B)),V=e(function(t){(t.exports=function(t,e){return S[t]||(S[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.1",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),q=0,W=Math.random(),Y=V("keys"),H={},z=D.WeakMap;if(G){var K=new z,J=K.get,$=K.has,Q=K.set;I=function(t,e){return Q.call(K,t,e),e},j=function(t){return J.call(K,t)||{}},F=function(t){return $.call(K,t)}}else{var X=P("state");H[X]=!0,I=function(t,e){return N(t,X,e),e},j=function(t){return h(t,X)?t[X]:{}},F=function(t){return h(t,X)}}function Z(t){return"function"==typeof t?t:void 0}function tt(t,e){return arguments.length<2?Z(vt[t])||Z(D[t]):vt[t]&&vt[t][e]||D[t]&&D[t][e]}function et(t){return isNaN(t=+t)?0:(0<t?bt:mt)(t)}function rt(t){return 0<t?Et(et(t),9007199254740991):0}function nt(t,e){var r=et(t);return r<0?wt(r+e,0):Tt(r,e)}function ot(c){return function(t,e,r){var n,o=f(t),i=rt(o.length),a=nt(r,i);if(c&&e!=e){for(;a<i;)if((n=o[a++])!=n)return!0}else for(;a<i;a++)if((c||a in o)&&o[a]===e)return c||a||0;return!c&&-1}}function it(t,e){var r,n=f(t),o=0,i=[];for(r in n)!h(H,r)&&h(n,r)&&i.push(r);for(;e.length>o;)h(n,r=e[o++])&&(~xt(i,r)||i.push(r));return i}function at(t,e){for(var r=It(e),n=M.f,o=_.f,i=0;i<r.length;i++){var a=r[i];h(t,a)||n(t,a,o(e,a))}}function ct(t,e){var r=Dt[Lt(t)];return r==_t||r!=Ut&&("function"==typeof e?l(e):!!e)}function ut(t,e){var r,n,o,i,a,c=t.target,u=t.global,f=t.stat;if(r=u?D:f?D[c]||d(c,{}):(D[c]||{}).prototype)for(n in e){if(i=e[n],o=t.noTargetGet?(a=Nt(r,n))&&a.value:r[n],!Mt(u?n:c+(f?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;at(i,o)}(t.sham||o&&o.sham)&&N(i,"sham",!0),gt(r,n,i,t)}}function ft(t){return Object(p(t))}function st(t,e,r){var n=s(e);n in t?M.f(t,n,R(0,r)):t[n]=r}function lt(t){return h(Bt,t)||(Ft&&h(Gt,t)?Bt[t]=Gt[t]:Bt[t]=Vt("Symbol."+t)),Bt[t]}function pt(t,e){var r;return jt(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!jt(r.prototype)?L(r)&&null===(r=r[qt])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}var ht,dt,yt={set:I,get:j,has:F,enforce:function(t){return F(t)?j(t):I(t,{})},getterFor:function(r){return function(t){var e;if(!L(t)||(e=j(t)).type!==r)throw TypeError("Incompatible receiver, "+r+" required");return e}}},gt=e(function(t){var e=yt.get,c=yt.enforce,u=String(String).split("String");(t.exports=function(t,e,r,n){var o=!!n&&!!n.unsafe,i=!!n&&!!n.enumerable,a=!!n&&!!n.noTargetGet;"function"==typeof r&&("string"!=typeof e||h(r,"name")||N(r,"name",e),c(r).source=u.join("string"==typeof e?e:"")),t!==D?(o?!a&&t[e]&&(i=!0):delete t[e],i?t[e]=r:N(t,e,r)):i?t[e]=r:d(e,r)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||k(this)})}),vt=D,mt=Math.ceil,bt=Math.floor,Et=Math.min,wt=Math.max,Tt=Math.min,At={includes:ot(!0),indexOf:ot(!1)},xt=At.indexOf,St=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ot=St.concat("length","prototype"),Ct={f:Object.getOwnPropertyNames||function(t){return it(t,Ot)}},Pt={f:Object.getOwnPropertySymbols},It=tt("Reflect","ownKeys")||function(t){var e=Ct.f(w(t)),r=Pt.f;return r?e.concat(r(t)):e},Rt=/#|\.prototype\./,Lt=ct.normalize=function(t){return String(t).replace(Rt,".").toLowerCase()},Dt=ct.data={},Ut=ct.NATIVE="N",_t=ct.POLYFILL="P",Mt=ct,Nt=_.f,jt=Array.isArray||function(t){return"Array"==o(t)},Ft=!!Object.getOwnPropertySymbols&&!l(function(){return!String(Symbol())}),kt=Ft&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Bt=V("wks"),Gt=D.Symbol,Vt=kt?Gt:Gt&&Gt.withoutSetter||C,qt=lt("species"),Wt=tt("navigator","userAgent")||"",Yt=D.process,Ht=Yt&&Yt.versions,zt=Ht&&Ht.v8;zt?dt=(ht=zt.split("."))[0]+ht[1]:Wt&&(!(ht=Wt.match(/Edge\/(\d+)/))||74<=ht[1])&&(ht=Wt.match(/Chrome\/(\d+)/))&&(dt=ht[1]);function Kt(e){return 51<=$t||!l(function(){var t=[];return(t.constructor={})[Qt]=function(){return{foo:1}},1!==t[e](Boolean).foo})}function Jt(t){if(!L(t))return!1;var e=t[Xt];return void 0!==e?!!e:jt(t)}var $t=dt&&+dt,Qt=lt("species"),Xt=lt("isConcatSpreadable"),Zt=9007199254740991,te="Maximum allowed index exceeded",ee=51<=$t||!l(function(){var t=[];return t[Xt]=!1,t.concat()[0]!==t}),re=Kt("concat");ut({target:"Array",proto:!0,forced:!ee||!re},{concat:function(t){var e,r,n,o,i,a=ft(this),c=pt(a,0),u=0;for(e=-1,n=arguments.length;e<n;e++)if(Jt(i=-1===e?a:arguments[e])){if(o=rt(i.length),Zt<u+o)throw TypeError(te);for(r=0;r<o;r++,u++)r in i&&st(c,u,i[r])}else{if(Zt<=u)throw TypeError(te);st(c,u++,i)}return c.length=u,c}});function ne(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}function oe(n,o,t){if(ne(n),void 0===o)return n;switch(t){case 0:return function(){return n.call(o)};case 1:return function(t){return n.call(o,t)};case 2:return function(t,e){return n.call(o,t,e)};case 3:return function(t,e,r){return n.call(o,t,e,r)}}return function(){return n.apply(o,arguments)}}function ie(h){var d=1==h,y=2==h,g=3==h,v=4==h,m=6==h,b=5==h||m;return function(t,e,r,n){for(var o,i,a=ft(t),c=E(a),u=oe(e,r,3),f=rt(c.length),s=0,l=n||pt,p=d?l(t,f):y?l(t,0):void 0;s<f;s++)if((b||s in c)&&(i=u(o=c[s],s,a),h))if(d)p[s]=i;else if(i)switch(h){case 3:return!0;case 5:return o;case 6:return s;case 2:fe.call(p,o)}else if(v)return!1;return m?-1:g||v?v:p}}function ae(){}function ce(t){return"<script>"+t+"</"+ye+">"}var ue,fe=[].push,se={forEach:ie(0),map:ie(1),filter:ie(2),some:ie(3),every:ie(4),find:ie(5),findIndex:ie(6)},le=Object.keys||function(t){return it(t,St)},pe=U?Object.defineProperties:function(t,e){w(t);for(var r,n=le(e),o=n.length,i=0;i<o;)M.f(t,r=n[i++],e[r]);return t},he=tt("document","documentElement"),de="prototype",ye="script",ge=P("IE_PROTO"),ve=function(){try{ue=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;ve=ue?function(t){t.write(ce("")),t.close();var e=t.parentWindow.Object;return t=null,e}(ue):((e=n("iframe")).style.display="none",he.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ce("document.F=Object")),t.close(),t.F);for(var r=St.length;r--;)delete ve[de][St[r]];return ve()};H[ge]=!0;var me=Object.create||function(t,e){var r;return null!==t?(ae[de]=w(t),r=new ae,ae[de]=null,r[ge]=t):r=ve(),void 0===e?r:pe(r,e)},be=lt("unscopables"),Ee=Array.prototype;null==Ee[be]&&M.f(Ee,be,{configurable:!0,value:me(null)});function we(t){Ee[be][t]=!0}var Te=se.find,Ae="find",xe=!0;Ae in[]&&Array(1)[Ae](function(){xe=!1}),ut({target:"Array",proto:!0,forced:xe},{find:function(t,e){return Te(this,t,1<arguments.length?e:void 0)}}),we(Ae);var Se=At.includes;ut({target:"Array",proto:!0},{includes:function(t,e){return Se(this,t,1<arguments.length?e:void 0)}}),we("includes");var Oe,Ce,Pe,Ie={},Re=!l(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Le=P("IE_PROTO"),De=Object.prototype,Ue=Re?Object.getPrototypeOf:function(t){return t=ft(t),h(t,Le)?t[Le]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?De:null},_e=lt("iterator"),Me=!1;[].keys&&("next"in(Pe=[].keys())?(Ce=Ue(Ue(Pe)))!==Object.prototype&&(Oe=Ce):Me=!0),null==Oe&&(Oe={}),h(Oe,_e)||N(Oe,_e,function(){return this});function Ne(t,e,r){t&&!h(t=r?t:t.prototype,Ge)&&Be(t,Ge,{configurable:!0,value:e})}function je(){return this}function Fe(){return this}var ke={IteratorPrototype:Oe,BUGGY_SAFARI_ITERATORS:Me},Be=M.f,Ge=lt("toStringTag"),Ve=ke.IteratorPrototype,qe=Object.setPrototypeOf||("__proto__"in{}?function(){var r,n=!1,t={};try{(r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(t,[]),n=t instanceof Array}catch(t){}return function(t,e){return w(t),function(t){if(!L(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(e),n?r.call(t,e):t.__proto__=e,t}}():void 0),We=ke.IteratorPrototype,Ye=ke.BUGGY_SAFARI_ITERATORS,He=lt("iterator"),ze="values",Ke="entries",Je="Array Iterator",$e=yt.set,Qe=yt.getterFor(Je),Xe=function(t,e,r,n,o,i,a){var c,u,f;u=n,f=e+" Iterator",(c=r).prototype=me(Ve,{next:R(1,u)}),Ne(c,f,!1),Ie[f]=je;function s(t){if(t===o&&m)return m;if(!Ye&&t in g)return g[t];switch(t){case"keys":case ze:case Ke:return function(){return new r(this,t)}}return function(){return new r(this)}}var l,p,h,d=e+" Iterator",y=!1,g=t.prototype,v=g[He]||g["@@iterator"]||o&&g[o],m=!Ye&&v||s(o),b="Array"==e&&g.entries||v;if(b&&(l=Ue(b.call(new t)),We!==Object.prototype&&l.next&&(Ue(l)!==We&&(qe?qe(l,We):"function"!=typeof l[He]&&N(l,He,Fe)),Ne(l,d,!0))),o==ze&&v&&v.name!==ze&&(y=!0,m=function(){return v.call(this)}),g[He]!==m&&N(g,He,m),Ie[e]=m,o)if(p={values:s(ze),keys:i?m:s("keys"),entries:s(Ke)},a)for(h in p)!Ye&&!y&&h in g||gt(g,h,p[h]);else ut({target:e,proto:!0,forced:Ye||y},p);return p}(Array,"Array",function(t,e){$e(this,{type:Je,target:f(t),index:0,kind:e})},function(){var t=Qe(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?{value:t.target=void 0,done:!0}:"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values");Ie.Arguments=Ie.Array,we("keys"),we("values"),we("entries");var Ze=lt("species"),tr=[].slice,er=Math.max;ut({target:"Array",proto:!0,forced:!Kt("slice")},{slice:function(t,e){var r,n,o,i=f(this),a=rt(i.length),c=nt(t,a),u=nt(void 0===e?a:e,a);if(jt(i)&&("function"!=typeof(r=i.constructor)||r!==Array&&!jt(r.prototype)?L(r)&&null===(r=r[Ze])&&(r=void 0):r=void 0,r===Array||void 0===r))return tr.call(i,c,u);for(n=new(void 0===r?Array:r)(er(u-c,0)),o=0;c<u;c++,o++)c in i&&st(n,o,i[c]);return n.length=o,n}});var rr={};rr[lt("toStringTag")]="z";function nr(t){return L(t)&&h(Sr,ur(t))}var or,ir="[object z]"===String(rr),ar=lt("toStringTag"),cr="Arguments"==o(function(){return arguments}()),ur=ir?o:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ar))?r:cr?o(e):"Object"==(n=o(e))&&"function"==typeof e.callee?"Arguments":n},fr=M.f,sr=D.DataView,lr=sr&&sr.prototype,pr=D.Int8Array,hr=pr&&pr.prototype,dr=D.Uint8ClampedArray,yr=dr&&dr.prototype,gr=pr&&Ue(pr),vr=hr&&Ue(hr),mr=Object.prototype,br=mr.isPrototypeOf,Er=lt("toStringTag"),wr=C("TYPED_ARRAY_TAG"),Tr=!(!D.ArrayBuffer||!sr),Ar=Tr&&!!qe&&"Opera"!==ur(D.opera),xr=!1,Sr={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(or in Sr)D[or]||(Ar=!1);if((!Ar||"function"!=typeof gr||gr===Function.prototype)&&(gr=function(){throw TypeError("Incorrect invocation")},Ar))for(or in Sr)D[or]&&qe(D[or],gr);if((!Ar||!vr||vr===mr)&&(vr=gr.prototype,Ar))for(or in Sr)D[or]&&qe(D[or].prototype,vr);if(Ar&&Ue(yr)!==vr&&qe(yr,vr),U&&!h(vr,Er))for(or in xr=!0,fr(vr,Er,{get:function(){return L(this)?this[wr]:void 0}}),Sr)D[or]&&N(D[or],wr,or);Tr&&qe&&Ue(lr)!==mr&&qe(lr,mr);function Or(t,e,r){for(var n in e)gt(t,n,e[n],r);return t}function Cr(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t}function Pr(t){if(void 0===t)return 0;var e=et(t),r=rt(e);if(e!==r)throw RangeError("Wrong length or index");return r}function Ir(t,e,r){for(var n=ft(this),o=rt(n.length),i=arguments.length,a=nt(1<i?e:void 0,o),c=2<i?r:void 0,u=void 0===c?o:nt(c,o);a<u;)n[a++]=t;return n}function Rr(t){return[255&t]}function Lr(t){return[255&t,t>>8&255]}function Dr(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function Ur(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function _r(t){return cn(t,23,4)}function Mr(t){return cn(t,52,8)}function Nr(t,e){Jr(t[tn],e,{get:function(){return $r(this)[e]}})}function jr(t,e,r,n){var o=Pr(r),i=$r(t);if(o+e>i.byteLength)throw an(en);var a=$r(i.buffer).bytes,c=o+i.byteOffset,u=a.slice(c,c+e);return n?u:u.reverse()}function Fr(t,e,r,n,o,i){var a=Pr(r),c=$r(t);if(a+e>c.byteLength)throw an(en);for(var u=$r(c.buffer).bytes,f=a+c.byteOffset,s=n(+o),l=0;l<e;l++)u[f+l]=s[i?l:e-l-1]}var kr={NATIVE_ARRAY_BUFFER:Tr,NATIVE_ARRAY_BUFFER_VIEWS:Ar,TYPED_ARRAY_TAG:xr&&wr,aTypedArray:function(t){if(nr(t))return t;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(t){if(qe){if(br.call(gr,t))return t}else for(var e in Sr)if(h(Sr,or)){var r=D[e];if(r&&(t===r||br.call(r,t)))return t}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r){if(U){if(r)for(var n in Sr){var o=D[n];o&&h(o.prototype,t)&&delete o.prototype[t]}vr[t]&&!r||gt(vr,t,r?e:Ar&&hr[t]||e)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(U){if(qe){if(r)for(n in Sr)(o=D[n])&&h(o,t)&&delete o[t];if(gr[t]&&!r)return;try{return gt(gr,t,r?e:Ar&&pr[t]||e)}catch(t){}}for(n in Sr)!(o=D[n])||o[t]&&!r||gt(o,t,e)}},isView:function(t){var e=ur(t);return"DataView"===e||h(Sr,e)},isTypedArray:nr,TypedArray:gr,TypedArrayPrototype:vr},Br=Math.abs,Gr=Math.pow,Vr=Math.floor,qr=Math.log,Wr=Math.LN2,Yr=function(t,e,r){var n,o,i,a=new Array(r),c=8*r-e-1,u=(1<<c)-1,f=u>>1,s=23===e?Gr(2,-24)-Gr(2,-77):0,l=t<0||0===t&&1/t<0?1:0,p=0;for((t=Br(t))!=t||t===1/0?(o=t!=t?1:0,n=u):(n=Vr(qr(t)/Wr),t*(i=Gr(2,-n))<1&&(n--,i*=2),2<=(t+=1<=n+f?s/i:s*Gr(2,1-f))*i&&(n++,i/=2),u<=n+f?(o=0,n=u):1<=n+f?(o=(t*i-1)*Gr(2,e),n+=f):(o=t*Gr(2,f-1)*Gr(2,e),n=0));8<=e;a[p++]=255&o,o/=256,e-=8);for(n=n<<e|o,c+=e;0<c;a[p++]=255&n,n/=256,c-=8);return a[--p]|=128*l,a},Hr=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,c=o-7,u=n-1,f=t[u--],s=127&f;for(f>>=7;0<c;s=256*s+t[u],u--,c-=8);for(r=s&(1<<-c)-1,s>>=-c,c+=e;0<c;r=256*r+t[u],u--,c-=8);if(0===s)s=1-a;else{if(s===i)return r?NaN:f?-1/0:1/0;r+=Gr(2,e),s-=a}return(f?-1:1)*r*Gr(2,s-e)},zr=kr.NATIVE_ARRAY_BUFFER,Kr=Ct.f,Jr=M.f,$r=yt.get,Qr=yt.set,Xr="ArrayBuffer",Zr="DataView",tn="prototype",en="Wrong index",rn=D[Xr],nn=rn,on=D[Zr],an=D.RangeError,cn=Yr,un=Hr;if(zr){if(!l(function(){rn(1)})||!l(function(){new rn(-1)})||l(function(){return new rn,new rn(1.5),new rn(NaN),rn.name!=Xr})){for(var fn,sn=(nn=function(t){return Cr(this,nn),new rn(Pr(t))})[tn]=rn[tn],ln=Kr(rn),pn=0;ln.length>pn;)(fn=ln[pn++])in nn||N(nn,fn,rn[fn]);sn.constructor=nn}var hn=new on(new nn(2)),dn=on[tn].setInt8;hn.setInt8(0,2147483648),hn.setInt8(1,2147483649),!hn.getInt8(0)&&hn.getInt8(1)||Or(on[tn],{setInt8:function(t,e){dn.call(this,t,e<<24>>24)},setUint8:function(t,e){dn.call(this,t,e<<24>>24)}},{unsafe:!0})}else nn=function(t){Cr(this,nn,Xr);var e=Pr(t);Qr(this,{bytes:Ir.call(new Array(e),0),byteLength:e}),U||(this.byteLength=e)},on=function(t,e,r){Cr(this,on,Zr),Cr(t,nn,Zr);var n=$r(t).byteLength,o=et(e);if(o<0||n<o)throw an("Wrong offset");if(n<o+(r=void 0===r?n-o:rt(r)))throw an("Wrong length");Qr(this,{buffer:t,byteLength:r,byteOffset:o}),U||(this.buffer=t,this.byteLength=r,this.byteOffset=o)},U&&(Nr(nn,"byteLength"),Nr(on,"buffer"),Nr(on,"byteLength"),Nr(on,"byteOffset")),Or(on[tn],{getInt8:function(t){return jr(this,1,t)[0]<<24>>24},getUint8:function(t){return jr(this,1,t)[0]},getInt16:function(t,e){var r=jr(this,2,t,1<arguments.length?e:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t,e){var r=jr(this,2,t,1<arguments.length?e:void 0);return r[1]<<8|r[0]},getInt32:function(t,e){return Ur(jr(this,4,t,1<arguments.length?e:void 0))},getUint32:function(t,e){return Ur(jr(this,4,t,1<arguments.length?e:void 0))>>>0},getFloat32:function(t,e){return un(jr(this,4,t,1<arguments.length?e:void 0),23)},getFloat64:function(t,e){return un(jr(this,8,t,1<arguments.length?e:void 0),52)},setInt8:function(t,e){Fr(this,1,t,Rr,e)},setUint8:function(t,e){Fr(this,1,t,Rr,e)},setInt16:function(t,e,r){Fr(this,2,t,Lr,e,2<arguments.length?r:void 0)},setUint16:function(t,e,r){Fr(this,2,t,Lr,e,2<arguments.length?r:void 0)},setInt32:function(t,e,r){Fr(this,4,t,Dr,e,2<arguments.length?r:void 0)},setUint32:function(t,e,r){Fr(this,4,t,Dr,e,2<arguments.length?r:void 0)},setFloat32:function(t,e,r){Fr(this,4,t,_r,e,2<arguments.length?r:void 0)},setFloat64:function(t,e,r){Fr(this,8,t,Mr,e,2<arguments.length?r:void 0)}});Ne(nn,Xr),Ne(on,Zr);function yn(t){var e=tt(t),r=M.f;U&&e&&!e[vn]&&r(e,vn,{configurable:!0,get:function(){return this}})}var gn={ArrayBuffer:nn,DataView:on},vn=lt("species"),mn="ArrayBuffer",bn=gn[mn],En=D[mn];ut({global:!0,forced:En!==bn},{ArrayBuffer:bn}),yn(mn);var wn=Object.assign,Tn=Object.defineProperty,An=!wn||l(function(){if(U&&1!==wn({b:1},wn(Tn({},"a",{enumerable:!0,get:function(){Tn(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=wn({},t)[r]||le(wn({},e)).join("")!=n})?function(t,e){for(var r=ft(t),n=arguments.length,o=1,i=Pt.f,a=y.f;o<n;)for(var c,u=E(arguments[o++]),f=i?le(u).concat(i(u)):le(u),s=f.length,l=0;l<s;)c=f[l++],U&&!a.call(u,c)||(r[c]=u[c]);return r}:wn;ut({target:"Object",stat:!0,forced:Object.assign!==An},{assign:An});var xn=l(function(){le(1)});ut({target:"Object",stat:!0,forced:xn},{keys:function(t){return le(ft(t))}});var Sn=ir?{}.toString:function(){return"[object "+ur(this)+"]"};ir||gt(Object.prototype,"toString",Sn,{unsafe:!0});function On(t){return void 0!==t&&(Ie.Array===t||Ln[Rn]===t)}function Cn(t){if(null!=t)return t[Dn]||t["@@iterator"]||Ie[ur(t)]}function Pn(e,t,r,n){try{return n?t(w(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&w(o.call(e)),t}}var In=D.Promise,Rn=lt("iterator"),Ln=Array.prototype,Dn=lt("iterator"),Un=e(function(t){function h(t,e){this.stopped=t,this.result=e}(t.exports=function(t,e,r,n,o){var i,a,c,u,f,s,l,p=oe(e,r,n?2:1);if(o)i=t;else{if("function"!=typeof(a=Cn(t)))throw TypeError("Target is not iterable");if(On(a)){for(c=0,u=rt(t.length);c<u;c++)if((f=n?p(w(l=t[c])[0],l[1]):p(t[c]))&&f instanceof h)return f;return new h(!1)}i=a.call(t)}for(s=i.next;!(l=s.call(i)).done;)if("object"==typeof(f=Pn(i,p,l.value,n))&&f&&f instanceof h)return f;return new h(!1)}).stop=function(t){return new h(!0,t)}}),_n=lt("iterator"),Mn=!1;try{var Nn=0,jn={next:function(){return{done:!!Nn++}},return:function(){Mn=!0}};jn[_n]=function(){return this},Array.from(jn,function(){throw 2})}catch(t){}function Fn(t,e){if(!e&&!Mn)return!1;var r=!1;try{var n={};n[_n]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r}function kn(t,e){var r,n=w(t).constructor;return void 0===n||null==(r=w(n)[zn])?e:ne(r)}function Bn(t){if(ro.hasOwnProperty(t)){var e=ro[t];delete ro[t],e()}}function Gn(t){return function(){Bn(t)}}function Vn(t){Bn(t.data)}function qn(t){D.postMessage(t+"",Jn.protocol+"//"+Jn.host)}var Wn,Yn,Hn,zn=lt("species"),Kn=/(iphone|ipod|ipad).*applewebkit/i.test(Wt),Jn=D.location,$n=D.setImmediate,Qn=D.clearImmediate,Xn=D.process,Zn=D.MessageChannel,to=D.Dispatch,eo=0,ro={},no="onreadystatechange";$n&&Qn||($n=function(t){for(var e=[],r=1;r<arguments.length;)e.push(arguments[r++]);return ro[++eo]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Wn(eo),eo},Qn=function(t){delete ro[t]},"process"==o(Xn)?Wn=function(t){Xn.nextTick(Gn(t))}:to&&to.now?Wn=function(t){to.now(Gn(t))}:Zn&&!Kn?(Hn=(Yn=new Zn).port2,Yn.port1.onmessage=Vn,Wn=oe(Hn.postMessage,Hn,1)):!D.addEventListener||"function"!=typeof postMessage||D.importScripts||l(qn)?Wn=no in n("script")?function(t){he.appendChild(n("script"))[no]=function(){he.removeChild(this),Bn(t)}}:function(t){setTimeout(Gn(t),0)}:(Wn=qn,D.addEventListener("message",Vn,!1)));var oo,io,ao,co,uo,fo,so,lo,po={set:$n,clear:Qn},ho=_.f,yo=po.set,go=D.MutationObserver||D.WebKitMutationObserver,vo=D.process,mo=D.Promise,bo="process"==o(vo),Eo=ho(D,"queueMicrotask"),wo=Eo&&Eo.value;wo||(oo=function(){var t,e;for(bo&&(t=vo.domain)&&t.exit();io;){e=io.fn,io=io.next;try{e()}catch(t){throw io?co():ao=void 0,t}}ao=void 0,t&&t.enter()},co=bo?function(){vo.nextTick(oo)}:go&&!Kn?(uo=!0,fo=document.createTextNode(""),new go(oo).observe(fo,{characterData:!0}),function(){fo.data=uo=!uo}):mo&&mo.resolve?(so=mo.resolve(void 0),lo=so.then,function(){lo.call(so,oo)}):function(){yo.call(D,oo)});function To(t){var r,n;this.promise=new t(function(t,e){if(void 0!==r||void 0!==n)throw TypeError("Bad Promise constructor");r=t,n=e}),this.resolve=ne(r),this.reject=ne(n)}function Ao(t,e){if(w(t),L(e)&&e.constructor===t)return e;var r=Mo.f(t);return(0,r.resolve)(e),r.promise}function xo(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}function So(t){var e;return!(!L(t)||"function"!=typeof(e=t.then))&&e}function Oo(l,p,h){if(!p.notified){p.notified=!0;var d=p.reactions;_o(function(){for(var t=p.value,e=1==p.state,r=0;d.length>r;){var n,o,i,a=d[r++],c=e?a.ok:a.fail,u=a.resolve,f=a.reject,s=a.domain;try{c?(e||(2===p.rejection&&ri(l,p),p.rejection=1),!0===c?n=t:(s&&s.enter(),n=c(t),s&&(s.exit(),i=!0)),n===a.promise?f(qo("Promise-chain cycle")):(o=So(n))?o.call(n,u,f):u(n)):f(t)}catch(t){s&&!i&&s.exit(),f(t)}}p.reactions=[],p.notified=!1,h&&!p.rejection&&ti(l,p)})}}function Co(t,e,r){var n,o;$o?((n=Wo.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),D.dispatchEvent(n)):n={promise:e,reason:r},(o=D["on"+t])?o(n):t===Qo&&function(t,e){var r=D.console;r&&r.error&&(1===arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)}function Po(e,r,n,o){return function(t){e(r,n,t,o)}}function Io(t,e,r,n){e.done||(e.done=!0,n&&(e=n),e.value=r,e.state=2,Oo(t,e,!0))}var Ro,Lo,Do,Uo,_o=wo||function(t){var e={fn:t,next:void 0};ao&&(ao.next=e),io||(io=e,co()),ao=e},Mo={f:function(t){return new To(t)}},No=po.set,jo=lt("species"),Fo="Promise",ko=yt.get,Bo=yt.set,Go=yt.getterFor(Fo),Vo=In,qo=D.TypeError,Wo=D.document,Yo=D.process,Ho=tt("fetch"),zo=Mo.f,Ko=zo,Jo="process"==o(Yo),$o=!!(Wo&&Wo.createEvent&&D.dispatchEvent),Qo="unhandledrejection",Xo=Mt(Fo,function(){if(!(k(Vo)!==String(Vo))){if(66===$t)return!0;if(!Jo&&"function"!=typeof PromiseRejectionEvent)return!0}if(51<=$t&&/native code/.test(Vo))return!1;function t(t){t(function(){},function(){})}var e=Vo.resolve(1);return(e.constructor={})[jo]=t,!(e.then(function(){})instanceof t)}),Zo=Xo||!Fn(function(t){Vo.all(t).catch(function(){})}),ti=function(r,n){No.call(D,function(){var t,e=n.value;if(ei(n)&&(t=xo(function(){Jo?Yo.emit("unhandledRejection",e,r):Co(Qo,r,e)}),n.rejection=Jo||ei(n)?2:1,t.error))throw t.value})},ei=function(t){return 1!==t.rejection&&!t.parent},ri=function(t,e){No.call(D,function(){Jo?Yo.emit("rejectionHandled",t):Co("rejectionhandled",t,e.value)})},ni=function(r,n,t,e){if(!n.done){n.done=!0,e&&(n=e);try{if(r===t)throw qo("Promise can't be resolved itself");var o=So(t);o?_o(function(){var e={done:!1};try{o.call(t,Po(ni,r,e,n),Po(Io,r,e,n))}catch(t){Io(r,e,t,n)}}):(n.value=t,n.state=1,Oo(r,n,!1))}catch(t){Io(r,{done:!1},t,n)}}};Xo&&(Vo=function(t){Cr(this,Vo,Fo),ne(t),Ro.call(this);var e=ko(this);try{t(Po(ni,this,e),Po(Io,this,e))}catch(t){Io(this,e,t)}},(Ro=function(){Bo(this,{type:Fo,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Or(Vo.prototype,{then:function(t,e){var r=Go(this),n=zo(kn(this,Vo));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Jo?Yo.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&Oo(this,r,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Lo=function(){var t=new Ro,e=ko(t);this.promise=t,this.resolve=Po(ni,t,e),this.reject=Po(Io,t,e)},Mo.f=zo=function(t){return t===Vo||t===Do?new Lo(t):Ko(t)},"function"==typeof In&&(Uo=In.prototype.then,gt(In.prototype,"then",function(t,e){var r=this;return new Vo(function(t,e){Uo.call(r,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof Ho&&ut({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return Ao(Vo,Ho.apply(D,arguments))}}))),ut({global:!0,wrap:!0,forced:Xo},{Promise:Vo}),Ne(Vo,Fo,!1),yn(Fo),Do=tt(Fo),ut({target:Fo,stat:!0,forced:Xo},{reject:function(t){var e=zo(this);return e.reject.call(void 0,t),e.promise}}),ut({target:Fo,stat:!0,forced:Xo},{resolve:function(t){return Ao(this,t)}}),ut({target:Fo,stat:!0,forced:Zo},{all:function(t){var c=this,e=zo(c),u=e.resolve,f=e.reject,r=xo(function(){var n=ne(c.resolve),o=[],i=0,a=1;Un(t,function(t){var e=i++,r=!1;o.push(void 0),a++,n.call(c,t).then(function(t){r||(r=!0,o[e]=t,--a||u(o))},f)}),--a||u(o)});return r.error&&f(r.value),e.promise},race:function(t){var r=this,n=zo(r),o=n.reject,e=xo(function(){var e=ne(r.resolve);Un(t,function(t){e.call(r,t).then(n.resolve,o)})});return e.error&&o(e.value),n.promise}});function oi(t,e){return RegExp(t,e)}var ii,ai,ci={UNSUPPORTED_Y:l(function(){var t=oi("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),BROKEN_CARET:l(function(){var t=oi("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},ui=RegExp.prototype.exec,fi=String.prototype.replace,si=ui,li=(ii=/a/,ai=/b*/g,ui.call(ii,"a"),ui.call(ai,"a"),0!==ii.lastIndex||0!==ai.lastIndex),pi=ci.UNSUPPORTED_Y||ci.BROKEN_CARET,hi=void 0!==/()??/.exec("")[1];(li||hi||pi)&&(si=function(t){var e,r,n,o,i=this,a=pi&&i.sticky,c=function(){var t=w(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}.call(i),u=i.source,f=0,s=t;return a&&(-1===(c=c.replace("y","")).indexOf("g")&&(c+="g"),s=String(t).slice(i.lastIndex),0<i.lastIndex&&(!i.multiline||i.multiline&&"\n"!==t[i.lastIndex-1])&&(u="(?: "+u+")",s=" "+s,f++),r=new RegExp("^(?:"+u+")",c)),hi&&(r=new RegExp("^"+u+"$(?!\\s)",c)),li&&(e=i.lastIndex),n=ui.call(a?r:i,s),a?n?(n.input=n.input.slice(f),n[0]=n[0].slice(f),n.index=i.lastIndex,i.lastIndex+=n[0].length):i.lastIndex=0:li&&n&&(i.lastIndex=i.global?n.index+n[0].length:e),hi&&n&&1<n.length&&fi.call(n[0],r,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)}),n});var di=si;ut({target:"RegExp",proto:!0,forced:/./.exec!==di},{exec:di});function yi(t){var e;return L(t)&&(void 0!==(e=t[gi])?!!e:"RegExp"==o(t))}var gi=lt("match"),vi=lt("match");ut({target:"String",proto:!0,forced:!function(e){var r=/./;try{"/./"[e](r)}catch(t){try{return r[vi]=!1,"/./"[e](r)}catch(t){}}return!1}("includes")},{includes:function(t,e){return!!~String(p(this)).indexOf(function(t){if(yi(t))throw TypeError("The method doesn't accept regular expressions");return t}(t),1<arguments.length?e:void 0)}});function mi(c){return function(t,e){var r,n,o=String(p(t)),i=et(e),a=o.length;return i<0||a<=i?c?"":void 0:(r=o.charCodeAt(i))<55296||56319<r||i+1===a||(n=o.charCodeAt(i+1))<56320||57343<n?c?o.charAt(i):r:c?o.slice(i,i+2):n-56320+(r-55296<<10)+65536}}function bi(t,e){var r=t.exec;if("function"==typeof r){var n=r.call(t,e);if("object"!=typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==o(t))throw TypeError("RegExp#exec called on incompatible receiver");return di.call(t,e)}var Ei=lt("species"),wi=!l(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),Ti="$0"==="a".replace(/./,"$0"),Ai=!l(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}),xi={codeAt:mi(!1),charAt:mi(!0)}.charAt,Si=[].push,Oi=Math.min,Ci=4294967295,Pi=!l(function(){return!RegExp(Ci,"y")});!function(r,t,e,n){var o=lt(r),i=!l(function(){var t={};return t[o]=function(){return 7},7!=""[r](t)}),a=i&&!l(function(){var t=!1,e=/a/;return"split"===r&&((e={constructor:{}}).constructor[Ei]=function(){return e},e.flags="",e[o]=/./[o]),e.exec=function(){return t=!0,null},e[o](""),!t});if(!i||!a||"replace"===r&&(!wi||!Ti)||"split"===r&&!Ai){var c=/./[o],u=e(o,""[r],function(t,e,r,n,o){return e.exec===di?i&&!o?{done:!0,value:c.call(e,r,n)}:{done:!0,value:t.call(r,e,n)}:{done:!1}},{REPLACE_KEEPS_$0:Ti}),f=u[0],s=u[1];gt(String.prototype,r,f),gt(RegExp.prototype,o,2==t?function(t,e){return s.call(t,this,e)}:function(t){return s.call(t,this)})}n&&N(RegExp.prototype[o],"sham",!0)}("split",2,function(o,m,b){var E;return E="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(t,e){var r=String(p(this)),n=void 0===e?Ci:e>>>0;if(0==n)return[];if(void 0===t)return[r];if(!yi(t))return m.call(r,t,n);for(var o,i,a,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,s=new RegExp(t.source,u+"g");(o=di.call(s,r))&&!(f<(i=s.lastIndex)&&(c.push(r.slice(f,o.index)),1<o.length&&o.index<r.length&&Si.apply(c,o.slice(1)),a=o[0].length,f=i,c.length>=n));)s.lastIndex===o.index&&s.lastIndex++;return f===r.length?!a&&s.test("")||c.push(""):c.push(r.slice(f)),c.length>n?c.slice(0,n):c}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:m.call(this,t,e)}:m,[function(t,e){var r=p(this),n=null==t?void 0:t[o];return void 0!==n?n.call(t,r,e):E.call(String(r),t,e)},function(t,e){var r=b(E,t,this,e,E!==m);if(r.done)return r.value;var n=w(t),o=String(this),i=kn(n,RegExp),a=n.unicode,c=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(Pi?"y":"g"),u=new i(Pi?n:"^(?:"+n.source+")",c),f=void 0===e?Ci:e>>>0;if(0==f)return[];if(0===o.length)return null===bi(u,o)?[o]:[];for(var s,l,p=0,h=0,d=[];h<o.length;){u.lastIndex=Pi?h:0;var y,g=bi(u,Pi?o:o.slice(h));if(null===g||(y=Oi(rt(u.lastIndex+(Pi?0:h)),o.length))===p)s=o,h=(l=h)+(a?xi(s,l).length:1);else{if(d.push(o.slice(p,h)),d.length===f)return d;for(var v=1;v<=g.length-1;v++)if(d.push(g[v]),d.length===f)return d;h=p=y}}return d.push(o.slice(p)),d}]},!Pi);function Ii(t,e){var r=function(t){var e=et(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}(t);if(r%e)throw RangeError("Wrong offset");return r}function Ri(t,e,r){var n,o,i,a,c,u,f=ft(t),s=arguments.length,l=1<s?e:void 0,p=void 0!==l,h=Cn(f);if(null!=h&&!On(h))for(u=(c=h.call(f)).next,f=[];!(a=u.call(c)).done;)f.push(a.value);for(p&&2<s&&(l=oe(l,r,2)),o=rt(f.length),i=new(Mi(this))(o),n=0;n<o;n++)i[n]=p?l(f[n],n):f[n];return i}var Li=kr.NATIVE_ARRAY_BUFFER_VIEWS,Di=D.ArrayBuffer,Ui=D.Int8Array,_i=!Li||!l(function(){Ui(1)})||!l(function(){new Ui(-1)})||!Fn(function(t){new Ui,new Ui(null),new Ui(1.5),new Ui(t)},!0)||l(function(){return 1!==new Ui(new Di(2),1,void 0).length}),Mi=kr.aTypedArrayConstructor;e(function(t){function d(t,e){for(var r=0,n=e.length,o=new(a(t))(n);r<n;)o[r]=e[r++];return o}function e(t,e){m(t,e,{get:function(){return g(this)[e]}})}function y(t){var e;return t instanceof w||"ArrayBuffer"==(e=ur(t))||"SharedArrayBuffer"==e}function n(t,e){return C(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)}function r(t,e){return n(t,e=s(e,!0))?R(2,t[e]):i(t,e)}function o(t,e,r){return!(n(t,e=s(e,!0))&&L(r)&&h(r,"value"))||h(r,"get")||h(r,"set")||r.configurable||h(r,"writable")&&!r.writable||h(r,"enumerable")&&!r.enumerable?m(t,e,r):(t[e]=r.value,t)}var c=Ct.f,u=se.forEach,g=yt.get,v=yt.set,m=M.f,i=_.f,b=Math.round,E=D.RangeError,w=gn.ArrayBuffer,T=gn.DataView,A=kr.NATIVE_ARRAY_BUFFER_VIEWS,x=kr.TYPED_ARRAY_TAG,S=kr.TypedArray,O=kr.TypedArrayPrototype,a=kr.aTypedArrayConstructor,C=kr.isTypedArray,P="BYTES_PER_ELEMENT",I="Wrong length";U?(A||(_.f=r,M.f=o,e(O,"buffer"),e(O,"byteOffset"),e(O,"byteLength"),e(O,"length")),ut({target:"Object",stat:!0,forced:!A},{getOwnPropertyDescriptor:r,defineProperty:o}),t.exports=function(t,e,i){function s(t,o){m(t,o,{get:function(){return t=o,(e=g(this)).view[r](t*l+e.byteOffset,!0);var t,e},set:function(t){return e=o,r=t,n=g(this),i&&(r=(r=b(r))<0?0:255<r?255:255&r),void n.view[a](e*l+n.byteOffset,r,!0);var e,r,n},enumerable:!0})}var l=t.match(/\d+$/)[0]/8,p=t+(i?"Clamped":"")+"Array",r="get"+t,a="set"+t,f=D[p],h=f,n=h&&h.prototype,o={};A?_i&&(h=e(function(t,e,r,n){return Cr(t,h,p),o=L(e)?y(e)?void 0!==n?new f(e,Ii(r,l),n):void 0!==r?new f(e,Ii(r,l)):new f(e):C(e)?d(h,e):Ri.call(h,e):new f(Pr(e)),i=t,a=h,qe&&"function"==typeof(c=i.constructor)&&c!==a&&L(u=c.prototype)&&u!==a.prototype&&qe(o,u),o;var o,i,a,c,u}),qe&&qe(h,S),u(c(f),function(t){t in h||N(h,t,f[t])}),h.prototype=n):(h=e(function(t,e,r,n){Cr(t,h,p);var o,i,a,c=0,u=0;if(L(e)){if(!y(e))return C(e)?d(h,e):Ri.call(h,e);o=e,u=Ii(r,l);var f=e.byteLength;if(void 0===n){if(f%l)throw E(I);if((i=f-u)<0)throw E(I)}else if(f<(i=rt(n)*l)+u)throw E(I);a=i/l}else a=Pr(e),o=new w(i=a*l);for(v(t,{buffer:o,byteOffset:u,byteLength:i,length:a,view:new T(o)});c<a;)s(t,c++)}),qe&&qe(h,S),n=h.prototype=me(O)),n.constructor!==h&&N(n,"constructor",h),x&&N(n,x,p),o[p]=h,ut({global:!0,forced:h!=f,sham:!A},o),P in h||N(h,P,l),P in n||N(n,P,l),yn(p)}):t.exports=function(){}})("Uint8",function(n){return function(t,e,r){return n(this,t,e,r)}});var Ni=Math.min,ji=[].copyWithin||function(t,e,r){var n=ft(this),o=rt(n.length),i=nt(t,o),a=nt(e,o),c=2<arguments.length?r:void 0,u=Ni((void 0===c?o:nt(c,o))-a,o-i),f=1;for(a<i&&i<a+u&&(f=-1,a+=u-1,i+=u-1);0<u--;)a in n?n[i]=n[a]:delete n[i],i+=f,a+=f;return n},Fi=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("copyWithin",function(t,e,r){return ji.call(Fi(this),t,e,2<arguments.length?r:void 0)});var ki=se.every,Bi=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("every",function(t,e){return ki(Bi(this),t,1<arguments.length?e:void 0)});var Gi=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("fill",function(t){return Ir.apply(Gi(this),arguments)});var Vi=se.filter,qi=kr.aTypedArray,Wi=kr.aTypedArrayConstructor;(0,kr.exportTypedArrayMethod)("filter",function(t,e){for(var r=Vi(qi(this),t,1<arguments.length?e:void 0),n=kn(this,this.constructor),o=0,i=r.length,a=new(Wi(n))(i);o<i;)a[o]=r[o++];return a});var Yi=se.find,Hi=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("find",function(t,e){return Yi(Hi(this),t,1<arguments.length?e:void 0)});var zi=se.findIndex,Ki=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("findIndex",function(t,e){return zi(Ki(this),t,1<arguments.length?e:void 0)});var Ji=se.forEach,$i=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("forEach",function(t,e){Ji($i(this),t,1<arguments.length?e:void 0)});var Qi=At.includes,Xi=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("includes",function(t,e){return Qi(Xi(this),t,1<arguments.length?e:void 0)});var Zi=At.indexOf,ta=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("indexOf",function(t,e){return Zi(ta(this),t,1<arguments.length?e:void 0)});function ea(){return oa.call(ca(this))}var ra=lt("iterator"),na=D.Uint8Array,oa=Xe.values,ia=Xe.keys,aa=Xe.entries,ca=kr.aTypedArray,ua=kr.exportTypedArrayMethod,fa=na&&na.prototype[ra],sa=!!fa&&("values"==fa.name||null==fa.name);ua("entries",function(){return aa.call(ca(this))}),ua("keys",function(){return ia.call(ca(this))}),ua("values",ea,!sa),ua(ra,ea,!sa);var la=kr.aTypedArray,pa=[].join;(0,kr.exportTypedArrayMethod)("join",function(t){return pa.apply(la(this),arguments)});function ha(t,e){var r=[][t];return!r||!l(function(){r.call(null,e||function(){throw 1},1)})}var da=Math.min,ya=[].lastIndexOf,ga=!!ya&&1/[1].lastIndexOf(1,-0)<0,va=ha("lastIndexOf"),ma=ga||va?function(t,e){if(ga)return ya.apply(this,arguments)||0;var r=f(this),n=rt(r.length),o=n-1;for(1<arguments.length&&(o=da(o,et(e))),o<0&&(o=n+o);0<=o;o--)if(o in r&&r[o]===t)return o||0;return-1}:ya,ba=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("lastIndexOf",function(t){return ma.apply(ba(this),arguments)});var Ea=se.map,wa=kr.aTypedArray,Ta=kr.aTypedArrayConstructor;(0,kr.exportTypedArrayMethod)("map",function(t,e){return Ea(wa(this),t,1<arguments.length?e:void 0,function(t,e){return new(Ta(kn(t,t.constructor)))(e)})});function Aa(f){return function(t,e,r,n){ne(e);var o=ft(t),i=E(o),a=rt(o.length),c=f?a-1:0,u=f?-1:1;if(r<2)for(;;){if(c in i){n=i[c],c+=u;break}if(c+=u,f?c<0:a<=c)throw TypeError("Reduce of empty array with no initial value")}for(;f?0<=c:c<a;c+=u)c in i&&(n=e(n,i[c],c,o));return n}}var xa={left:Aa(!1),right:Aa(!0)},Sa=xa.left,Oa=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("reduce",function(t,e){return Sa(Oa(this),t,arguments.length,1<arguments.length?e:void 0)});var Ca=xa.right,Pa=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("reduceRight",function(t,e){return Ca(Pa(this),t,arguments.length,1<arguments.length?e:void 0)});var Ia=kr.aTypedArray,Ra=kr.exportTypedArrayMethod,La=Math.floor;Ra("reverse",function(){for(var t,e=this,r=Ia(e).length,n=La(r/2),o=0;o<n;)t=e[o],e[o++]=e[--r],e[r]=t;return e});var Da=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("set",function(t,e){Da(this);var r=Ii(1<arguments.length?e:void 0,1),n=this.length,o=ft(t),i=rt(o.length),a=0;if(n<i+r)throw RangeError("Wrong length");for(;a<i;)this[r+a]=o[a++]},l(function(){new Int8Array(1).set({})}));var Ua=kr.aTypedArray,_a=kr.aTypedArrayConstructor,Ma=[].slice;(0,kr.exportTypedArrayMethod)("slice",function(t,e){for(var r=Ma.call(Ua(this),t,e),n=kn(this,this.constructor),o=0,i=r.length,a=new(_a(n))(i);o<i;)a[o]=r[o++];return a},l(function(){new Int8Array(1).slice()}));var Na=se.some,ja=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("some",function(t,e){return Na(ja(this),t,1<arguments.length?e:void 0)});var Fa=kr.aTypedArray,ka=[].sort;(0,kr.exportTypedArrayMethod)("sort",function(t){return ka.call(Fa(this),t)});var Ba=kr.aTypedArray;(0,kr.exportTypedArrayMethod)("subarray",function(t,e){var r=Ba(this),n=r.length,o=nt(t,n);return new(kn(r,r.constructor))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,rt((void 0===e?n:nt(e,n))-o))});var Ga=D.Int8Array,Va=kr.aTypedArray,qa=kr.exportTypedArrayMethod,Wa=[].toLocaleString,Ya=[].slice,Ha=!!Ga&&l(function(){Wa.call(new Ga(1))});qa("toLocaleString",function(){return Wa.apply(Ha?Ya.call(Va(this)):Va(this),arguments)},l(function(){return[1,2].toLocaleString()!=new Ga([1,2]).toLocaleString()})||!l(function(){Ga.prototype.toLocaleString.call([1,2])}));var za=kr.exportTypedArrayMethod,Ka=D.Uint8Array,Ja=Ka&&Ka.prototype||{},$a=[].toString,Qa=[].join;l(function(){$a.call({})})&&($a=function(){return Qa.call(this)}),za("toString",$a,Ja.toString!=$a);var Xa=se.forEach,Za=ha("forEach")?function(t,e){return Xa(this,t,1<arguments.length?e:void 0)}:[].forEach;for(var tc in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var ec=D[tc],rc=ec&&ec.prototype;if(rc&&rc.forEach!==Za)try{N(rc,"forEach",Za)}catch(t){rc.forEach=Za}}function nc(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function oc(t){return(oc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ic(t,e){return(ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ac(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cc(t,e,r){return(cc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oc(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function uc(n,v){var m=v.getLogger(),a=!0,i=window.md5,t=function(){function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),ac(this,oc(o).apply(this,arguments))}var t,e,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ic(t,e)}(o,n.DefaultConfig.loader),t=o,r=[{key:"setDebug",value:function(t){m.setLoggingEnabled(t)}},{key:"toggleUseCDN",value:function(){a=!a}},{key:"isPeeringEnabled",get:function(){return a},set:function(t){a=t}}],(e=[{key:"integrityCheck",value:function(t){if(m.log("integrityCheck etag="+this.segmentEtag),this.segmentEtag){var e=i(t),r='"'===this.segmentEtag[0]?this.segmentEtag.substring(1,this.segmentEtag.length-1):this.segmentEtag;return m.log("verifying md5 checksum of the segment md5sum="+e),e===r}return!0}},{key:"load",value:function(s,l,p){var h=this;if(m.info("URL ".concat(s.url," Range end ").concat(s.rangeEnd)),m.info("ctx: ",s),this.thetaCtx.cache.has(s.url+s.rangeEnd))m.info("load from cache - ",s.url,s.rangeEnd),cc(oc(o.prototype),"load",this).call(this,s,l,p);else if(null===this.thetaCtx.p2p.id)m.info("not connected to peerjs, load from CDN..."),this.loadFromCDN_old(s,l,p);else if(this.thetaCtx.p2p.useCDN&&!a)m.info("configuration has useCDN enabled, load from CDN..."),this.loadFromCDN_old(s,l,p);else{var d=this.thetaCtx.p2p,y=this.thetaCtx.playerStats,g=this;if(0===Object.keys(d.peers).length)m.info("no peer yet for ".concat(d.id,", load from UCN")),this.tryLoadFromUCN(s,l,p);else{var r=Math.floor(Date.now()),n=this.thetaCtx.p2p.probeTimeout,i=g._getNewUrl(s.url);m.info("New URL before probe is: ",i,s.rangeEnd);var t=.5<this._getCDNLoadedPercent(d.counterMap)?Math.ceil(6*Math.random())-3:Math.ceil(3*Math.random())+1;m.info("IMPROVE DEBUG - p2p object before probe is:",d.counterMap),d.probeFromPeerWithTimeout(i+s.rangeEnd,n,1,t).then(function(t){m.info("SPLIT DEBUG - response after probe:",t);var o=Math.floor(Date.now());m.info("probeFromPeerWithTimeout - fragment ".concat(i+s.rangeEnd," found from peer ").concat(t.peerid));var a=t.peerid;y.processFragmentReq(a,"probe_req_overview_replied"),y.processProbeReq(a,o-r);var e=d.failoverFactor,c=Math.floor(1e3*s.frag.duration*e);m.info("IMPROVE DEBUG - duration:".concat(s.frag.duration,", factor:").concat(e,", fragment timeout:").concat(c));var u=h.thetaCtx.p2p.allowRangeRequests?5:1,f=new Array(1+u);d.loadFromSpecificPeerWithTimeout(i+s.rangeEnd,a,c,u,f).then(function(t){var e;m.log("IMPROVE DEBUG - resp after load from peer:",t),t.forEach(function(t){void 0!==t&&(e=t)}),"kOK"===e.result?(m.log("SPLIT DEBUG - kOk res of loadFromSpecificPeerWithTimeout:",e),m.log("SPLIT DEBUG - data in kOk:",f),m.log("SPLIT DEBUG - ctx in kOK:",s),m.warn("IMPROVE DEBUG [BL] - Load from peer success, updating the get fragment results map"),d.updateGetFragResults(a,"success",5),h.loadFromPeer(s,e,a,y,o,d,p,f,l)):(m.warn("remote peer ".concat(a," reject getFragment req, try CDN")),m.warn("IMPROVE DEBUG [BL] - Load from peer failed, updating the get fragment results map"),d.updateGetFragResults(a,"failed",u),y.processFragmentReq(a,"fragment_req_rejected"),h.tryLoadFromUCN(s,l,p))}).catch(function(t){m.warn("loadFromSpecificPeer gets timeout, ".concat(s.url," try CDN  - ").concat(a));var i=f.slice(0);i.invoice=f.invoice,m.log("IMPROVE DEBUG - newData in catch:",i),t.message?m.error("error message -",t.message):m.error("error without msg -",t);var e=0;if(i.forEach(function(t){t&&"number"!=typeof t&&e++}),m.info("IMPROVE DEBUG - loaded segment length:",e),i[i.length-1]){var n=i.reduce(function(t,e){return g._appendBuffer(t,e)},new ArrayBuffer);if(d.updateGetFragResults(a,"success",e),d.updateGetFragResults(a,"failed",u-e),n.byteLength===i[i.length-1]){m.log("SPLIT DEBUG - [corner case] In corner case!");var r={data:n,invoice:i.invoice,totalLength:n.byteLength,type:"fragment",url:s.url};h.loadFromPeer(s,r,a,y,o,d,p)}else!function(){for(var o=[],t=0;t<i.length;t++)void 0===i[t]&&o.push(t);m.info("IMPROVE DEBUG - unloadSegment:",o),y.processFragmentReq(a,"fragment_req_timeout"),h.loadPartFromPeer(s.url,i,n.byteLength,a,c,y,d),s.totalNum=u;function e(n){new Promise(function(r,t){setTimeout(function(){var t=Object.assign({},s),e=Object.assign({},p);r(h.loadFromCDN(t,o[n],e,i)),m.log("IMPROVE DEBUG - In part CDN setTimeout times:",n)},n*c/10),m.log("IMPROVE DEBUG - In part CDN Timeout:",n*c/10)}),m.log("IMPROVE DEBUG - In part CDN in loop times:",n)}for(var r=0;r<o.length;r++)e(r)}()}else d.updateGetFragResults(a,"failed",5),y.processFragmentReq(a,"fragment_req_timeout"),m.log("SPLIT DEBUG - load from cdn use the old function."),h.tryLoadFromUCN(s,l,p)})}).catch(function(t){m.warn("probeFromPeerWithTimeout ends, ".concat(n," timeout")),m.warn("probeFromPeerWithTimeout ends with err: ",t);var e=h.thetaCtx.playerStats;"timeout"===t.type?e.processFragmentReq(null,"probe_req_overview_timeout"):e.processFragmentReq(null,"probe_req_overview_notCached"),h.tryLoadFromUCN(s,l,p)})}}}},{key:"loadFromCache",value:function(t,e,r){var n=t.url+t.rangeEnd;m.info("Serving from cache: ",n);var o=this.thetaCtx.cache.get(n);m.info("cachedItem: ",o);var i=null,a=null;null!=o&&(i=o[0].data.slice(0),a=o[1]);var c={data:i,url:t.url};m.info("response: ",c),m.info("cachedData: ",i),m.info("response: ",c),r.onSuccess(c,a,t)}},{key:"tryLoadFromUCN",value:function(r,n,o){var i=this;if(m.info("Loading url: ",r.url),this.thetaCtx.p2p.useUCN){var a=this.thetaCtx.p2p.ucn,t="https://".concat(a.host,":8080/live/").concat(this.thetaCtx.p2p.videoId,"/ucnmap.json");r.originalUrl=r.url,r.url=this._getNewUrl(r.url),this.getUcnMap(t,r.url).then(function(t){var e=t;r.ucnMap=Object.assign({},e),r.cdnUrl=r.url,r.url="https://".concat(a.host,":8080/live/").concat(e[r.cdnUrl]),i.loadFromUCN(r,n,o)}).catch(function(t){m.info("getUcnMap returns an error: ",t),m.info("getUcnMap didn't have the key, load from CDN"),r.url=r.originalUrl,i.loadFromCDN_old(r,n,o)})}else m.info("useUCN is false, load from CDN"),this.loadFromCDN_old(r,n,o)}},{key:"getUcnMap",value:function(t,a){return new Promise(function(n,o){m.log("Getting get UCN map "+t);var i=new XMLHttpRequest;try{i.open("GET",t,!0)}catch(t){m.error("Error in get UCN map.",t),o("Error - get UCN map.",t)}i.onload=function(t){m.info(i.response);var e=i.response;if(e){m.debug("DEBUG res - ",e);var r=JSON.parse(e);m.debug("UCN map is: ",r),r.hasOwnProperty(a)?n(r):(m.info("UCN map doesn't have ".concat(a," as a key")),o("Error - no matched key"))}},i.send()})}},{key:"loadPartFromPeer",value:function(t,e,r,n,o,i,a){m.log("SPLIT DEBUG - IN load part from peer"),m.log("SPLIT DEBUG - data",e),m.log("SPLIT DEBUG - url",t),m.log("SPLIT DEBUG - peerid",n);var c=null;e.invoice&&(c=e.invoice.address),this.thetaCtx.trigger(v.Events.TRAFFIC,{type:v.TrafficType.P2P_INBOUND,stats:{size:r},peer:{id:n,address:c}}),i.processFragment(t,"fromPeer",r,o),i.processFragmentReq(n,"fragment_req_replied");var u=a.peers[n];try{e.invoice?a.shouldSendPayment(e,n)?(m.log("SPLIT DEBUG - Sending payment to ".concat(e.invoice.address)),a.sendPayment(e.invoice,u)):m.log("SPLIT DEBUG - Should not send payment. Skipping payment."):m.log('SPLIT DEBUG - Skip payment: {"msg": "Error: Anonymous user"}')}catch(t){m.error("Error sending payment: ",t)}}},{key:"loadFromPeer",value:function(t,e,r,n,o,i,a){m.info("fragment ".concat(e.url," received from peer ").concat(r));var c={url:e.url,data:e.data},u={size:e.data.byteLength,loaded:e.data.byteLength,trequest:performance.now()},f=Math.floor(Date.now()),s=null;if(m.info("getFragment from peer, takes ".concat(f-o," ms")),this.integrityCheck(c.data.slice(0))){e.invoice&&(s=e.invoice.address),this.thetaCtx.trigger(v.Events.TRAFFIC,{type:v.TrafficType.P2P_INBOUND,stats:{size:c.data.byteLength},peer:{id:r,address:s}});var l=this._getNewUrl(t.url);m.info("Key in the cache from peers:",l+t.rangeEnd),this.thetaCtx.cache.set(l+t.rangeEnd,[{data:e.data.slice(0),url:e.url},u,t]),n.processFragment(t.url,"fromPeer",e.data.byteLength,f-o),n.processFragmentReq(r,"fragment_req_replied");var p=i.peers[r];try{e.invoice?(m.debug("Sending payment to ".concat(e.invoice.address)),i.sendPayment(e.invoice,p)):m.debug('Skip payment: {"msg": "Error: Anonymous user"}')}catch(t){m.error("Error sending payment: ",t)}a.onSuccess(c,u,t)}else m.error("segment integrity check (from peer) fails, skip loading")}},{key:"loadFromCDN",value:function(f,s,o,l){var p=Math.floor(Date.now()),h=this,i=new XMLHttpRequest;try{i.open("GET",f.url,!0)}catch(t){return void o.onError({code:i.status,text:t.message},f,i)}var d=l[l.length-1];f.rangeStart=Math.floor(d*(s/f.totalNum)),s===f.totalNum?f.rangeEnd=d:f.rangeEnd=Math.floor(d*((s+1)/f.totalNum))-1,m.info("IMPROCE DEBUG - start:".concat(f.rangeStart,", end:").concat(f.rangeEnd,", index:").concat(s,", total:").concat(f.totalNum)),f.rangeEnd&&i.setRequestHeader("Range","bytes="+f.rangeStart+"-"+f.rangeEnd),i.responseType=f.responseType,i.callbacks=o;var y=this.thetaCtx.playerStats,g=this.thetaCtx.p2p;i.onload=function(t){m.info(i.response);var e=i.response;if(e){var c=Object.assign({},o).onSuccess,u=h.thetaCtx.cache,r={size:e.byteLength,loaded:e.byteLength,trequest:performance.now()};i.callbacks.onSuccess=function(t,e,r){m.info("On Success ctx: ",r),g.updateGetFragResults("CDN","success",1);var n=Math.floor(Date.now()),o=n-p;if(m.info("getFragment from CDN, ".concat(t.data.byteLength," bytes takes ").concat(o," ms")),y.processFragment(r.url+"undefined","fromCDN",t.data.byteLength,n-p),h.integrityCheck(t.data.slice(0))){var i=h._getNewUrl(r.url);if(m.info("New URL before set cache is: ",i),h.thetaCtx.trigger(v.Events.TRAFFIC,{type:v.TrafficType.CDN,stats:{size:t.data.byteLength},peer:null}),l[s]=t.data,m.log("IMPROVE DEBUG - change data[index]:",s,l[s]),m.log("SPLIT DEBUG - data before newRes:",l),h._checkData(l)){m.log("IMPROVE DEBUG - check data returns true:",l);var a={url:t.url,data:l.reduce(function(t,e){return h._appendBuffer(t,e)},new ArrayBuffer)};u.set(i+"undefined",[{data:a.data.slice(0),url:t.url},e,r]),m.log("SPLIT DEBUG - is newRes data length match:",a.data.byteLength===d),m.log("SPLIT DEBUG - newRes:",a),c(a,e,f)}else m.log("IMPROVE DEBUG - check data returns false:",l)}else m.error("segment integrity check (from CDN) fails, skip loading")};var n={url:i.responseURL,data:e};i.onreadystatechange=h.readystatechange.bind(h),i.callbacks.onSuccess(n,r,f)}},i.send()}},{key:"readystatechange",value:function(t){cc(oc(o.prototype),"readystatechange",this).call(this,t)}},{key:"_getSequence",value:function(t){for(var e=[],r=0;r<t;r++)e[r]=r;return e=this._shuffle(e)}},{key:"_shuffle",value:function(t){for(var e,r,n=t.length;0<n;)r=Math.floor(Math.random()*n),e=t[--n],t[n]=t[r],t[r]=e;return t}},{key:"_appendBuffer",value:function(t,e){if(!t||!t.byteLength)return e;if(!e||!e.byteLength)return t;var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t),0),r.set(new Uint8Array(e),t.byteLength),r.buffer}},{key:"_checkData",value:function(t){for(var e=0;e<t.length;e++)if(void 0===t[e])return!1;return!0}},{key:"_changeCJUrl",value:function(t){var e=t.split("/media_");return e[0]+"/media_"+e[1].split("_")[1]}},{key:"_byPassQueryUrl",value:function(t){var e=t;t.includes(".ts?")&&(e=t.split(".ts?")[0]+".ts");return e}},{key:"_getCDNUrl",value:function(t,e){var r=t.split("/live/")[1];m.info("In get CDN url, url is: ".concat(t,". val = ").concat(r));var n;return n=e?Object.keys(e).find(function(t){return e[t]===r}):"",m.log("Get CDN url: ",n),n}},{key:"_getNewUrl",value:function(t){var e=t;return"cjhellothetatestnet"===this.thetaCtx.p2p.videoId?e=this._changeCJUrl(t):this.thetaCtx.p2p.segUrlBypassQuery&&(e=this._byPassQueryUrl(t)),e=this._byPassQueryUrl(e)}},{key:"loadFromUCN",value:function(t,e,r){var a=this;m.info("ThetaHlsJsFragmentLoader: loadFromUCN");var c=this,u=this.thetaCtx.cache,f=r.onSuccess,s=Math.floor(Date.now()),l=this.thetaCtx.playerStats;r.onSuccess=function(t,e,r){var n=Math.floor(Date.now()),o=n-s;if(m.info("getFragment from UCN, ".concat(t.data.byteLength," bytes takes ").concat(o," ms")),l.processFragment(r.url,"fromPeer",t.data.byteLength,n-s),a.integrityCheck(t.data.slice(0))){var i=c._getCDNUrl(r.url,r.ucnMap);u.set(i+r.rangeEnd,[{data:t.data.slice(0),url:t.url},e,r]),a.thetaCtx.trigger(v.Events.TRAFFIC,{type:v.TrafficType.P2P_INBOUND,stats:{size:t.data.byteLength},peer:null}),f(t,e,r)}else m.error("segment integrity check (from UCN) fails, skip loading")},cc(oc(o.prototype),"load",this).call(this,t,e,r)}},{key:"loadFromCDN_old",value:function(t,e,r){var a=this;m.info("ThetaHlsJsFragmentLoader: loadFromCDN"),m.info("Loading url: ",t.url,t.rangeEnd);var c=this.thetaCtx.cache,u=r.onSuccess,f=Math.floor(Date.now()),s=this.thetaCtx.playerStats,l=this.thetaCtx.p2p,p=this;r.onSuccess=function(t,e,r){m.info("On Success ctx: ",r.rangeEnd,r),m.info("IMPROVE DEBUG - In old cdn, p2p object:",l),l.updateGetFragResults("CDN","success",5);var n=Math.floor(Date.now()),o=n-f;if(m.info("getFragment from CDN, ".concat(t.data.byteLength," bytes takes ").concat(o," ms")),s.processFragment(r.url,"fromCDN",t.data.byteLength,n-f),a.integrityCheck(t.data.slice(0))){var i=p._getNewUrl(r.url);m.info("New URL before set cache is: ",i,r.rangeEnd),c.set(i+r.rangeEnd,[{data:t.data.slice(0),url:t.url},e,r]),a.thetaCtx.trigger(v.Events.TRAFFIC,{type:v.TrafficType.CDN,stats:{size:t.data.byteLength},peer:null}),u(t,e,r)}else m.error("segment integrity check (from CDN) fails, skip loading")},cc(oc(o.prototype),"load",this).call(this,t,e,r)}},{key:"_getCDNLoadedPercent",value:function(e){var t=e.CDN?e.CDN.success:0,r=0;Object.keys(e).forEach(function(t){"CDN"!==t&&(r+=e[t].success)});var n=r+t;return m.info("IMPROVE DEBUG - calc cdn percentage: peerNum:".concat(r,", cdnNum:").concat(t)),n?t/n:1}}])&&nc(t.prototype,e),r&&nc(t,r),o}();v.registerPlugin("hlsjs",t)}return window&&window.Hls&&window.Theta&&uc(window.Hls,window.Theta),{registerPlugin:uc}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ThetaHlsJsFragmentLoader=e()});
